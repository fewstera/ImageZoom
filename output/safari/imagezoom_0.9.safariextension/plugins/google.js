// ==UserScript==
// @name Plugin
// @require js/jquery.min.js
// @all-frames true
// @include *://*.google.com/*
// @include *://google.com/*
// @include *://*.google.ad/*
// @include *://google.ad/*
// @include *://*.google.ae/*
// @include *://google.ae/*
// @include *://*.google.com.af/*
// @include *://google.com.af/*
// @include *://*.google.com.ag/*
// @include *://google.com.ag/*
// @include *://*.google.com.ai/*
// @include *://google.com.ai/*
// @include *://*.google.am/*
// @include *://google.am/*
// @include *://*.google.it.ao/*
// @include *://google.it.ao/*
// @include *://*.google.com.ar/*
// @include *://google.com.ar/*
// @include *://*.google.as/*
// @include *://google.as/*
// @include *://*.google.at/*
// @include *://google.at/*
// @include *://*.google.com.au/*
// @include *://google.com.au/*
// @include *://*.google.az/*
// @include *://google.az/*
// @include *://*.google.ba/*
// @include *://google.ba/*
// @include *://*.google.com.bd/*
// @include *://google.com.bd/*
// @include *://*.google.be/*
// @include *://google.be/*
// @include *://*.google.bg/*
// @include *://google.bg/*
// @include *://*.google.com.bh/*
// @include *://google.com.bh/*
// @include *://*.google.bi/*
// @include *://google.bi/*
// @include *://*.google.bj/*
// @include *://google.bj/*
// @include *://*.google.com.bn/*
// @include *://google.com.bn/*
// @include *://*.google.com.bo/*
// @include *://google.com.bo/*
// @include *://*.google.com.br/*
// @include *://google.com.br/*
// @include *://*.google.bs/*
// @include *://google.bs/*
// @include *://*.google.co.bw/*
// @include *://google.co.bw/*
// @include *://*.google.com.by/*
// @include *://google.com.by/*
// @include *://*.google.com.bz/*
// @include *://google.com.bz/*
// @include *://*.google.ca/*
// @include *://google.ca/*
// @include *://*.google.cd/*
// @include *://google.cd/*
// @include *://*.google.cf/*
// @include *://google.cf/*
// @include *://*.google.cg/*
// @include *://google.cg/*
// @include *://*.google.ch/*
// @include *://google.ch/*
// @include *://*.google.ci/*
// @include *://google.ci/*
// @include *://*.google.co.ck/*
// @include *://google.co.ck/*
// @include *://*.google.cl/*
// @include *://google.cl/*
// @include *://*.google.cn/*
// @include *://google.cn/*
// @include *://*.google.com.co/*
// @include *://google.com.co/*
// @include *://*.google.co.cr/*
// @include *://google.co.cr/*
// @include *://*.google.com.cu/*
// @include *://google.com.cu/*
// @include *://*.google.com.cy/*
// @include *://google.com.cy/*
// @include *://*.google.cz/*
// @include *://google.cz/*
// @include *://*.google.de/*
// @include *://google.de/*
// @include *://*.google.dj/*
// @include *://google.dj/*
// @include *://*.google.dk/*
// @include *://google.dk/*
// @include *://*.google.dm/*
// @include *://google.dm/*
// @include *://*.google.com.do/*
// @include *://google.com.do/*
// @include *://*.google.dz/*
// @include *://google.dz/*
// @include *://*.google.com.ec/*
// @include *://google.com.ec/*
// @include *://*.google.ee/*
// @include *://google.ee/*
// @include *://*.google.com.eg/*
// @include *://google.com.eg/*
// @include *://*.google.es/*
// @include *://google.es/*
// @include *://*.google.com.et/*
// @include *://google.com.et/*
// @include *://*.google.fi/*
// @include *://google.fi/*
// @include *://*.google.com.fj/*
// @include *://google.com.fj/*
// @include *://*.google.fm/*
// @include *://google.fm/*
// @include *://*.google.fr/*
// @include *://google.fr/*
// @include *://*.google.ga/*
// @include *://google.ga/*
// @include *://*.google.ge/*
// @include *://google.ge/*
// @include *://*.google.gg/*
// @include *://google.gg/*
// @include *://*.google.com.gh/*
// @include *://google.com.gh/*
// @include *://*.google.com.gi/*
// @include *://google.com.gi/*
// @include *://*.google.gl/*
// @include *://google.gl/*
// @include *://*.google.gm/*
// @include *://google.gm/*
// @include *://*.google.gp/*
// @include *://google.gp/*
// @include *://*.google.gr/*
// @include *://google.gr/*
// @include *://*.google.com.gt/*
// @include *://google.com.gt/*
// @include *://*.google.gy/*
// @include *://google.gy/*
// @include *://*.google.com.hk/*
// @include *://google.com.hk/*
// @include *://*.google.hn/*
// @include *://google.hn/*
// @include *://*.google.hr/*
// @include *://google.hr/*
// @include *://*.google.ht/*
// @include *://google.ht/*
// @include *://*.google.hu/*
// @include *://google.hu/*
// @include *://*.google.co.id/*
// @include *://google.co.id/*
// @include *://*.google.ie/*
// @include *://google.ie/*
// @include *://*.google.co.il/*
// @include *://google.co.il/*
// @include *://*.google.im/*
// @include *://google.im/*
// @include *://*.google.co.in/*
// @include *://google.co.in/*
// @include *://*.google.co.in/*
// @include *://google.co.in/*
// @include *://*.google.is/*
// @include *://google.is/*
// @include *://*.google.is/*
// @include *://google.is/*
// @include *://*.google.it/*
// @include *://google.it/*
// @include *://*.google.it/*
// @include *://google.it/*
// @include *://*.google.je/*
// @include *://google.je/*
// @include *://*.google.com.jm/*
// @include *://google.com.jm/*
// @include *://*.google.jo/*
// @include *://google.jo/*
// @include *://*.google.co.jp/*
// @include *://google.co.jp/*
// @include *://*.google.co.ke/*
// @include *://google.co.ke/*
// @include *://*.google.com.kh/*
// @include *://google.com.kh/*
// @include *://*.google.ki/*
// @include *://google.ki/*
// @include *://*.google.kg/*
// @include *://google.kg/*
// @include *://*.google.co.kr/*
// @include *://google.co.kr/*
// @include *://*.google.com.kw/*
// @include *://google.com.kw/*
// @include *://*.google.kz/*
// @include *://google.kz/*
// @include *://*.google.la/*
// @include *://google.la/*
// @include *://*.google.com.lb/*
// @include *://google.com.lb/*
// @include *://*.google.li/*
// @include *://google.li/*
// @include *://*.google.lk/*
// @include *://google.lk/*
// @include *://*.google.co.ls/*
// @include *://google.co.ls/*
// @include *://*.google.lt/*
// @include *://google.lt/*
// @include *://*.google.lu/*
// @include *://google.lu/*
// @include *://*.google.lv/*
// @include *://google.lv/*
// @include *://*.google.com.ly/*
// @include *://google.com.ly/*
// @include *://*.google.co.ma/*
// @include *://google.co.ma/*
// @include *://*.google.md/*
// @include *://google.md/*
// @include *://*.google.me/*
// @include *://google.me/*
// @include *://*.google.mg/*
// @include *://google.mg/*
// @include *://*.google.mk/*
// @include *://google.mk/*
// @include *://*.google.mn/*
// @include *://google.mn/*
// @include *://*.google.ms/*
// @include *://google.ms/*
// @include *://*.google.com.mt/*
// @include *://google.com.mt/*
// @include *://*.google.mu/*
// @include *://google.mu/*
// @include *://*.google.mv/*
// @include *://google.mv/*
// @include *://*.google.mw/*
// @include *://google.mw/*
// @include *://*.google.com.mx/*
// @include *://google.com.mx/*
// @include *://*.google.com.my/*
// @include *://google.com.my/*
// @include *://*.google.co.mz/*
// @include *://google.co.mz/*
// @include *://*.google.com.na/*
// @include *://google.com.na/*
// @include *://*.google.com.nf/*
// @include *://google.com.nf/*
// @include *://*.google.com.ng/*
// @include *://google.com.ng/*
// @include *://*.google.com.ni/*
// @include *://google.com.ni/*
// @include *://*.google.nl/*
// @include *://google.nl/*
// @include *://*.google.no/*
// @include *://google.no/*
// @include *://*.google.com.np/*
// @include *://google.com.np/*
// @include *://*.google.nr/*
// @include *://google.nr/*
// @include *://*.google.nu/*
// @include *://google.nu/*
// @include *://*.google.co.nz/*
// @include *://google.co.nz/*
// @include *://*.google.com.om/*
// @include *://google.com.om/*
// @include *://*.google.com.pa/*
// @include *://google.com.pa/*
// @include *://*.google.com.pe/*
// @include *://google.com.pe/*
// @include *://*.google.com.ph/*
// @include *://google.com.ph/*
// @include *://*.google.com.pk/*
// @include *://google.com.pk/*
// @include *://*.google.pl/*
// @include *://google.pl/*
// @include *://*.google.pn/*
// @include *://google.pn/*
// @include *://*.google.com.pr/*
// @include *://google.com.pr/*
// @include *://*.google.ps/*
// @include *://google.ps/*
// @include *://*.google.pt/*
// @include *://google.pt/*
// @include *://*.google.com.py/*
// @include *://google.com.py/*
// @include *://*.google.com.qa/*
// @include *://google.com.qa/*
// @include *://*.google.ro/*
// @include *://google.ro/*
// @include *://*.google.ru/*
// @include *://google.ru/*
// @include *://*.google.rw/*
// @include *://google.rw/*
// @include *://*.google.com.sa/*
// @include *://google.com.sa/*
// @include *://*.google.com.sb/*
// @include *://google.com.sb/*
// @include *://*.google.sc/*
// @include *://google.sc/*
// @include *://*.google.se/*
// @include *://google.se/*
// @include *://*.google.com.sg/*
// @include *://google.com.sg/*
// @include *://*.google.sh/*
// @include *://google.sh/*
// @include *://*.google.si/*
// @include *://google.si/*
// @include *://*.google.sk/*
// @include *://google.sk/*
// @include *://*.google.com.sl/*
// @include *://google.com.sl/*
// @include *://*.google.sn/*
// @include *://google.sn/*
// @include *://*.google.sm/*
// @include *://google.sm/*
// @include *://*.google.st/*
// @include *://google.st/*
// @include *://*.google.com.sv/*
// @include *://google.com.sv/*
// @include *://*.google.td/*
// @include *://google.td/*
// @include *://*.google.tg/*
// @include *://google.tg/*
// @include *://*.google.co.th/*
// @include *://google.co.th/*
// @include *://*.google.com.tj/*
// @include *://google.com.tj/*
// @include *://*.google.tk/*
// @include *://google.tk/*
// @include *://*.google.tl/*
// @include *://google.tl/*
// @include *://*.google.tm/*
// @include *://google.tm/*
// @include *://*.google.to/*
// @include *://google.to/*
// @include *://*.google.com.tr/*
// @include *://google.com.tr/*
// @include *://*.google.tt/*
// @include *://google.tt/*
// @include *://*.google.com.tw/*
// @include *://google.com.tw/*
// @include *://*.google.co.tz/*
// @include *://google.co.tz/*
// @include *://*.google.com.ua/*
// @include *://google.com.ua/*
// @include *://*.google.co.ug/*
// @include *://google.co.ug/*
// @include *://*.google.co.uk/*
// @include *://google.co.uk/*
// @include *://*.google.com.uy/*
// @include *://google.com.uy/*
// @include *://*.google.co.uz/*
// @include *://google.co.uz/*
// @include *://*.google.com.vc/*
// @include *://google.com.vc/*
// @include *://*.google.co.ve/*
// @include *://google.co.ve/*
// @include *://*.google.vg/*
// @include *://google.vg/*
// @include *://*.google.co.vi/*
// @include *://google.co.vi/*
// @include *://*.google.com.vn/*
// @include *://google.com.vn/*
// @include *://*.google.vu/*
// @include *://google.vu/*
// @include *://*.google.ws/*
// @include *://google.ws/*
// @include *://*.google.rs/*
// @include *://google.rs/*
// @include *://*.google.co.za/*
// @include *://google.co.za/*
// @include *://*.google.co.zm/*
// @include *://google.co.zm/*
// @include *://*.google.co.zw/*
// @include *://google.co.zw/*
// @include *://*.google.cat/*
// @include *://google.cat/*
// ==/UserScript==

// Copyright (c) 2013 Romain Vallet <romain.vallet@gmail.com>
// Licensed under the MIT license, read license.txt

var hoverZoomPlugins = hoverZoomPlugins || [];
hoverZoomPlugins.push({
    name:'Google',
    prepareImgLinks:function (callback) {
	
		var res = [];
        hoverZoom.urlReplace(res,
            'a[href*="imgurl="]',
            /.*imgurl=([^&]+).*/,
            '$1'
        );
		callback($(res));
	
		// remove this when old google image is retired 
        function prepareImgLink(img) {
            var img = $(this);
			if (this.id != 'rg_hi' && img.data().hoverZoomSrc) { return; }
            var link = this.parentNode,
                href = link.href,
                imgUrlIndex = href.indexOf('imgurl=');
            href = href.substring(imgUrlIndex + 7, href.indexOf('&', imgUrlIndex));
            try {
                while (decodeURIComponent(href) != href)
                    href = decodeURIComponent(href);
            } catch (e) {
            }
			link.classList.remove('hoverZoomLink');
            img.data().hoverZoomSrc = [href];
            img.addClass('hoverZoomLink');
        }
        $('a[href*="imgurl="] > img').each(prepareImgLink);
        $('#rg_hi').load(prepareImgLink);
		
    }
});